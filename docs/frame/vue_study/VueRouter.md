# Vue Router

## ç›¸å…³ç†è§£

### 1.vue-router çš„ç†è§£

vueçš„ä¸€ä¸ªæ’ä»¶åº“ï¼Œä¸“é—¨ç”¨æ¥å®ç°SPAåº”ç”¨

### 2.å¯¹SPAåº”ç”¨çš„ç†è§£

1. **å•é¡µWebåº”ç”¨**ï¼ˆsingle page web applicationï¼Œ**SPA**ï¼‰
2. æ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå®Œæ•´çš„é¡µé¢
3. ç‚¹å‡»é¡µé¢ä¸­çš„å¯¼èˆªé“¾æ¥ä¸ä¼šåˆ·æ–°é¡µé¢ï¼Œåªä¼šåšé¡µé¢çš„å±€éƒ¨æ›´æ–°
4. æ•°æ®éœ€è¦é€šè¿‡ajaxè¯·æ±‚è·å–

### 3.è·¯ç”±çš„ç†è§£

1. ä»€ä¹ˆæ˜¯è·¯ç”±? 

   - ä¸€ä¸ªè·¯ç”±å°±æ˜¯ä¸€ç»„æ˜ å°„å…³ç³»ï¼ˆkey - valueï¼‰
   - keyä¸ºè·¯å¾„ï¼Œvalueå¯èƒ½æ˜¯ function æˆ– component

2. è·¯ç”±åˆ†ç±»ï¼š

   - **åç«¯è·¯ç”±**
     ç†è§£ï¼švalue æ˜¯ functionï¼Œç”¨äºå¤„ç†å®¢æˆ·ç«¯æäº¤çš„è¯·æ±‚
     å·¥ä½œè¿‡ç¨‹ï¼šæœåŠ¡å™¨æ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œæ ¹æ®**è¯·æ±‚è·¯å¾„**æ‰¾åˆ°åŒ¹é…çš„**å‡½æ•°**æ¥å¤„ç†è¯·æ±‚ï¼Œè¿”å›å“åº”æ•°æ®
   - **å‰ç«¯è·¯ç”±**
     ç†è§£ï¼švalue æ˜¯ componentï¼Œç”¨äºå±•ç¤ºé¡µé¢å†…å®¹
     å·¥ä½œè¿‡ç¨‹ï¼šå½“æµè§ˆå™¨çš„è·¯å¾„æ”¹å˜æ—¶ï¼Œå¯¹åº”çš„ç»„ä»¶å°±ä¼šæ˜¾ç¤º

## ä½¿ç”¨è·¯ç”±

> - vue-router4ï¼Œåªèƒ½ç”¨åœ¨vue3ä¸­
> - vue-router3ï¼Œåªèƒ½ç”¨åœ¨vue2ä¸­

1. å®‰è£…è·¯ç”± vue-router

   ```sh
   npm i vue-router@3
   ```

2. **`src/router/index.js`**ï¼Œé…ç½®è·¯ç”±

```javascript
/* è¯¥æ–‡ä»¶ä¸“é—¨ç”¨äºåˆ›å»ºæ•´ä¸ªåº”ç”¨çš„è·¯ç”±å™¨ */

import Vue from 'vue'
import VueRouter from 'vue-router'		 // å¼•å…¥VueRouter
import About from '../pages/About'	     // å¼•å…¥è·¯ç”±ç»„ä»¶
import Home from '../pages/Home'		// å¼•å…¥è·¯ç”±ç»„ä»¶

// åˆ›å»ºrouterå®ä¾‹å¯¹è±¡ï¼Œå»ç®¡ç†æ¯ä¸€ç»„è·¯ç”±è§„åˆ™
const router = new VueRouter({
    // å®šä¹‰è·¯ç”±é…ç½®
	routes:[
		{
			path:'/about',		// è®¾ç½®è·¯ç”±è·¯å¾„
			component:About		// æ³¨å†Œè·¯ç”±ç»„ä»¶
		},
		{
			path:'/home',		// è®¾ç½®è·¯ç”±è·¯å¾„
			component:Home		// æ³¨å†Œè·¯ç”±ç»„ä»¶
		}
	]
})
// æš´éœ²router
export default router
```

â€‹	åœ¨ **`src/main.js`** ä¸­å¼•å…¥å¹¶æŒ‚è½½ router é…ç½®é¡¹

```javascript
import Vue from 'vue'
import App from './App.vue'
import VueRouter from 'vue-router'   // å¼•å…¥VueRouter
import router from './router' 		// å¼•å…¥è·¯ç”±å™¨

// åº”ç”¨æ’ä»¶
Vue.use(VueRouter)

new Vue({
	el: '#app',,
	router // æŒ‚è½½è·¯ç”±å™¨
	render: h => h(App)
})
```

4. ä½¿ç”¨è·¯ç”±ï¼Œ**å£°æ˜å¼è·¯ç”±å¯¼èˆª**ï¼š**`<router-link></router-link>`** æµè§ˆå™¨ä¼šè¢«æ›¿æ¢ä¸ºaæ ‡ç­¾ã€‚active-class å¯é…ç½®é«˜äº®æ ·å¼

```vue
<!--è·¯ç”±åˆ‡æ¢-->
<router-link active-class="active" to="/about">About</router-link>
```

5. æŒ‡å®šå±•ç¤ºä½ (ä¸€èˆ¬åœ¨App.vueä¸­)

```vue
<!--è·¯ç”±å‡ºå£-->
<router-view></router-view>
```



## å‡ ä¸ªæ³¨æ„ç‚¹

1. è·¯ç”±ç»„ä»¶é€šå¸¸å­˜æ”¾åœ¨ **pages / views** æ–‡ä»¶å¤¹ï¼Œä¸€èˆ¬ç»„ä»¶é€šå¸¸å­˜æ”¾åœ¨ **components** æ–‡ä»¶å¤¹

2. é€šè¿‡åˆ‡æ¢ï¼Œâ€œéšè—â€ äº†çš„è·¯ç”±ç»„ä»¶ï¼Œ**é»˜è®¤æ˜¯è¢«é”€æ¯æ‰çš„ï¼Œéœ€è¦çš„æ—¶å€™å†å»æŒ‚è½½**

3. æ¯ä¸ªè·¯ç”±ç»„ä»¶éƒ½æœ‰ **`$routeå±æ€§`**ï¼Œé‡Œé¢<strong style="color:#DD5145">å­˜å‚¨ç€è‡ªå·±çš„è·¯ç”±ä¿¡æ¯</strong>ï¼Œæ˜¯ä¸€ä¸ªå±€éƒ¨çš„å¯¹è±¡ï¼Œå¯ä»¥è·å–å¯¹åº”çš„nameï¼Œpathï¼Œparamsï¼Œqueryç­‰

4. æ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ª routerï¼Œå¯ä»¥é€šè¿‡ç»„ä»¶çš„ **`$routerå±æ€§`** è·å–åˆ°

5. **`$router`** æ˜¯ VueRouter çš„ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡ **`Vue.use(VueRouter)`** å’Œ Vueæ„é€ å‡½æ•°å¾—åˆ°ä¸€ä¸ª router çš„å®ä¾‹å¯¹è±¡ï¼Œ

   è¿™ä¸ªå¯¹è±¡ä¸­æ˜¯ä¸€ä¸ªå…¨å±€çš„è·¯ç”±å®ä¾‹ï¼Œä»–åŒ…å«äº†æ‰€æœ‰çš„è·¯ç”±ï¼ŒåŒ…å«äº†è®¸å¤šå…³é”®çš„å¯¹è±¡å’Œå±æ€§ã€‚



## åµŒå¥—è·¯ç”±+é‡å®šå‘+è·¯ç”±å‘½å+è·¯ç”±å…ƒä¿¡æ¯

**1.é…ç½®è·¯ç”±è§„åˆ™**

åµŒå¥—è·¯ç”±ï¼Œä½¿ç”¨ **`children`** é…ç½®é¡¹

<strong style="color:#DD5145">è·¯ç”±å…ƒä¿¡æ¯</strong>ï¼šè·¯ç”±ä¸­ **`meta`** é…ç½®é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªé…ç½®é¡¹ä¸­æ·»åŠ ä¸€äº›**è‡ªå®šä¹‰å‚æ•°**ï¼Œç”¨äºåç»­çš„åˆ¤æ–­

```javascript
/* router/index.js æ–‡ä»¶ */
routes:[
    {
        // å½“è·¯å¾„æ˜¯/æ—¶ï¼Œä¼šåˆ‡æ¢åˆ°/home
        path: "/",
        redirect: "/home" 	// ğŸŸ¢é‡å®šå‘
    },
    {
        path:'/home',   	// è·¯ç”±è·¯å¾„
        component: Home,	// è·¯ç”±ç»„ä»¶
        // a meta field     // ğŸŸ¢è·¯ç”±å…ƒä¿¡æ¯
        meta: { 
            title: 'é¦–é¡µ',
            requiresAuth: true 
        },
        children:[ 			// é€šè¿‡childrené…ç½®å­çº§è·¯ç”±
            {
                path:'news', // ğŸŸ¢æ­¤å¤„ä¸€å®šä¸è¦å¸¦æ–œæ ï¼Œä¸èƒ½å†™æˆ /news
                name:'hello',    // ğŸŸ¢è·¯ç”±å‘½å
                component: News
            }
        ]
    },
]
```

**2.è·³è½¬ï¼ˆè¦å†™å®Œæ•´è·¯å¾„ï¼‰**

```vue
<router-link to="/home/news">News</router-link>
```

**3.æŒ‡å®šå±•ç¤ºä½** 

ä¸€çº§è·¯ç”±å…¥å£ï¼Œä¸€èˆ¬å†™åœ¨**`App.vue`**æ–‡ä»¶ä¸­ï¼›äºŒçº§è·¯ç”±å…¥å£ï¼Œä¸€èˆ¬å†™åœ¨çˆ¶ç»„ä»¶ä¸­

```vue
<router-view></router-view>
```

**4.ç”±å‘½åæ˜¯ä¸ºäº†ç®€åŒ–è·¯ç”±çš„è·³è½¬**

```vue
<!--ç®€åŒ–å‰ï¼Œéœ€è¦å†™å®Œæ•´çš„è·¯å¾„ -->
<router-link to="/demo/test/welcome">è·³è½¬</router-link>

<!--ç®€åŒ–åï¼Œç›´æ¥é€šè¿‡åå­—è·³è½¬ -->
<router-link :to="{name:'hello'}">è·³è½¬</router-link>

<!--ç®€åŒ–å†™æ³• é…åˆä¼ é€’å‚æ•° -->
<router-link :to="{ name:'hello', query:{id:666, title:'ä½ å¥½'} }">è·³è½¬</router-link>
```

## è·¯ç”±å¯¼èˆª

### å£°æ˜å¼è·¯ç”±å¯¼èˆª

```vue
<router-link to="/home">Home</router-link>
```

### ç¼–ç¨‹å¼è·¯ç”±å¯¼èˆª

[å‚è€ƒæ–‡ç« ](https://blog.csdn.net/weixin_44944943/article/details/110010466?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522168266552816800227461779%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=168266552816800227461779&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-110010466-null-null.142^v86^insert_down1,239^v2^insert_chatgpt&utm_term=this.%E2%80%8B%5C%24router.replace%28%7B%20%7D%29%09&spm=1018.2226.3001.4187)

ä½œç”¨ï¼šä¸å€ŸåŠ© **`<router-link>`** å®ç°è·¯ç”±è·³è½¬ï¼Œè®©è·¯ç”±è·³è½¬æ›´åŠ çµæ´»

- **`this.$router.push({path: '/è·¯å¾„'})`**ï¼šç›¸å½“äºç‚¹å‡»è·¯ç”±é“¾æ¥(å¯ä»¥è¿”å›åˆ°å½“å‰è·¯ç”±ç•Œé¢)
- æˆ– **`this.$router.push({name: "è·¯ç”±åç§°"})`**
- **`this.$router.replace({path})`**ï¼šç”¨æ–°è·¯ç”±æ›¿æ¢å½“å‰è·¯ç”±(ä¸å¯ä»¥è¿”å›åˆ°å½“å‰è·¯ç”±ç•Œé¢)
- **`this.$router.forward()`**ï¼šè¯·æ±‚(è¿”å›)ä¸‹ä¸€ä¸ªè®°å½•è·¯ç”±
- **`this.$router.back()`**ï¼šè¯·æ±‚(è¿”å›)ä¸Šä¸€ä¸ªè®°å½•è·¯ç”±
- **`this.$router.go(n)`**ï¼šå¯å‰è¿›ä¹Ÿå¯åé€€ï¼Œnä¸ºæ­£æ•°å‰è¿›nï¼Œä¸ºè´Ÿæ•°åé€€

1. ä½œç”¨ï¼šæ§åˆ¶è·¯ç”±è·³è½¬æ—¶æ“ä½œæµè§ˆå™¨å†å²è®°å½•çš„æ¨¡å¼

2. æµè§ˆå™¨çš„å†å²è®°å½•æœ‰ä¸¤ç§å†™å…¥æ–¹å¼ï¼š**push** å’Œ **replace**
   - pushï¼šæ˜¯è¿½åŠ å†å²è®°å½•ï¼Œè·¯ç”±è·³è½¬æ—¶å€™ **é»˜è®¤ä¸º push æ–¹å¼**
   - <strong style="color:#DD5145">replaceï¼šæ˜¯æ›¿æ¢å½“å‰è®°å½•</strong>

3. å¼€å¯ replace æ¨¡å¼
   - **`<router-link :replace="true" ...>News</router-link>`**
   - ç®€å†™ï¼š**`<router-link replace ...>News</router-link>`**

4. æ€»ç»“ï¼šæµè§ˆè®°å½•æœ¬è´¨æ˜¯ä¸€ä¸ª**æ ˆ**ï¼Œé»˜è®¤ pushï¼Œç‚¹å¼€æ–°é¡µé¢å°±ä¼šåœ¨æ ˆé¡¶è¿½åŠ ä¸€ä¸ªåœ°å€ï¼Œåé€€ï¼Œæ ˆé¡¶æŒ‡é’ˆå‘ä¸‹ç§»åŠ¨ï¼Œ<br>æ”¹ä¸º replace å°±æ˜¯ä¸è¿½åŠ ï¼Œè€Œå°†æ ˆé¡¶åœ°å€æ›¿æ¢

```js
/*
        $route 
          ç”¨æ¥è·å–è·¯ç”±å‚æ•°(paramsã€query)å’Œè·¯ç”±è·¯å¾„ï¼ˆpathï¼‰
        $router
          ç”¨æ¥ç¼–ç¨‹å¼å¯¼èˆª(pushã€replaceã€goã€backã€forward)

        ä¸¤ç§è·¯ç”±è·³è½¬çš„æ–¹å¼ï¼š
          1. è·¯ç”±é“¾æ¥å¯¼èˆª
            router-link
          2. ç¼–ç¨‹å¼å¯¼èˆª
            this.$router.push/replace()
            
            ï¼ˆ1ï¼‰å¦‚æœç‚¹å‡»é“¾æ¥æˆ–è€…æŒ‰é’®åªéœ€è¦è¿›è¡Œè·¯ç”±è·³è½¬ï¼Œé‚£ä¹ˆå°±ç”¨ç¬¬ä¸€ç§æ–¹å¼
              	ä¾‹å­ï¼šå¯¼èˆªé“¾æ¥
            ï¼ˆ2ï¼‰å¦‚æœç‚¹å‡»é“¾æ¥æˆ–è€…æŒ‰é’®éœ€è¦åšä¸€äº›å…¶ä»–äº‹ï¼Œå†è¿›è¡Œè·¯ç”±è·³è½¬ï¼Œé‚£ä¹ˆå°±ç”¨ç¬¬äºŒç§æ–¹å¼
              	ä¾‹å­ï¼šç™»å½•æŒ‰é’®ã€ä¿®æ”¹æŒ‰é’®
*/
```

ä¾‹å¦‚ï¼š

```js
methods: {
    push(id) {
        // ç¼–ç¨‹å¼å¯¼èˆª
        this.$router.push(`/home/message/detail/${id}?name=suzy&age=25`);
    },
    replace(id) {
        this.$router.replace(`/home/message/detail/${id}?name=suzy&age=25`);
    }
}
```

```html
<button @click="push(message.id)">push</button>
<button @click="replace(message.id)">replace</button>
```



## è·¯ç”±ä¼ å‚

### 1. queryå‚æ•°

å®ƒç›´æ¥å°±å¯ä»¥ä¼ å‚ä¸éœ€è¦å»è·¯ç”±ä¸­é…ç½®å‚æ•°ï¼Œå®ƒçš„**å‚æ•°åç§°ä¼šåœ¨ url åœ°å€ä¸Šæ˜¾ç¤ºå‡ºæ¥**ã€‚

1. ä¼ é€’å‚æ•°

   ```vue
   <!-- è·³è½¬å¹¶æºå¸¦queryå‚æ•°ï¼Œtoçš„ å­—ç¬¦ä¸²å†™æ³• -->
   <router-link :to="`/home/message/detail?id=${m.id}&title=${m.title}`">è·³è½¬</router-link>
   				
   <!-- è·³è½¬å¹¶æºå¸¦queryå‚æ•°ï¼Œtoçš„ å¯¹è±¡å†™æ³•ï¼ˆæ¨èï¼‰ -->
   <router-link :to="{ path:'/home/message/detail', query:{ id: m.id, title: m.title } }">è·³è½¬</router-link>
   ```

2. æ¥æ”¶å‚æ•°

   ```javascript
   this.$route.query.id
   this.$route.query.title
   ```

   

### 2. paramså‚æ•°

- query ç›¸å½“äºGETè¯·æ±‚ï¼Œé¡µé¢è·³è½¬çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨åœ°å€æ çœ‹åˆ°è¯·æ±‚å‚æ•°
- params ç›¸å½“äºPOSTè¯·æ±‚ï¼Œå‚æ•°ä¸ä¼šåœ¨åœ°å€æ ä¸­æ˜¾ç¤º
- params å‚æ•°ä¼ é€’çš„æ—¶å€™éœ€è¦ <strong style="color:#DD5145">å ä½</strong>

1. é…ç½®è·¯ç”±ï¼Œ**å£°æ˜æ¥æ”¶ params å‚æ•°**

   ```javascript
   /* router/index.js æ–‡ä»¶ */
   {
       path:'/home',
       component: Home,
       children:[
           {
               component:Message,
               children:[
                   {
                       path:'detail/:id?/:title?',  // ğŸŸ¢ä½¿ç”¨ å ä½ç¬¦ï¼Œå£°æ˜æ¥æ”¶paramså‚æ•°ï¼ŒğŸŸ¢åŠ ä¸€ä¸ª ? ä»£è¡¨å¯ä¼ å¯ä¸ä¼ 
                       component: Detail,
                       name:'xiangqing',		// ğŸŸ¢è·¯å¾„ä¸éœ€è¦åŠ  / ï¼Œå› ä¸ºå®ƒåªæ˜¯ä¸ªåå­—
                   }
               ]
           },
       ]
   }
   ```

2. ä¼ é€’å‚æ•°

æ³¨æ„ï¼šè·¯ç”±æºå¸¦ params å‚æ•°æ—¶ï¼Œè‹¥ä½¿ç”¨ to çš„å¯¹è±¡å†™æ³•ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨ **path** é…ç½®é¡¹ï¼Œ<strong style="color:#DD5415">åªèƒ½é€šè¿‡ name æ¥ä¼ å‚</strong>

   å®ƒä¼ é€’çš„**å‚æ•°åç§°ä¸ä¼šåœ¨æµè§ˆå™¨ä¸Šæ˜¾ç¤º**

   ```vue
<!-- è·³è½¬å¹¶æºå¸¦paramså‚æ•°ï¼Œtoçš„ å­—ç¬¦ä¸²å†™æ³• -->
<router-link :to="/home/message/detail/666/ä½ å¥½">è·³è½¬</router-link>

<!-- è·³è½¬å¹¶æºå¸¦paramså‚æ•°ï¼Œtoçš„ å¯¹è±¡å†™æ³• -->
<router-link :to="{ name:'xiangqing', params:{ id:666, title:'ä½ å¥½' } }">è·³è½¬</router-link>
   ```

3. æ¥æ”¶å‚æ•°

   ```javascript
   this.$route.params.id
   this.$route.params.title
   ```


### ä¸¤è€…ä¼ å‚å‚æ•°çš„åŒºåˆ«

- query ä¼ é€’é…ç½®çš„æ—¶pathï¼Œè€Œparamsä¼ é€’é…ç½®çš„æ˜¯nameï¼Œåœ¨paramsä¸­é…ç½®pathæ— æ•ˆ
- query åœ¨è·¯ç”±é…ç½®ä¸éœ€è¦è®¾ç½®å‚æ•°ï¼Œè€Œparamså¿…é¡»è®¾ç½®
- query ä¼ é€’çš„å‚æ•°ä¼šæ˜¾ç¤ºåœ¨åœ°å€æ ä¸­ï¼Œparamsåˆ™ä¸ä¼š
- params åˆ·æ–°åå‚æ•°ä¼šä¸¢å¤±ï¼Œæ•°æ®å®‰å…¨ï¼Œä½†æ˜¯queryä¼šä¿å­˜ä¼ é€’è¿‡æ¥çš„å€¼ï¼Œåˆ·æ–°ä¸å˜ï¼›

```js
// å­—ç¬¦ä¸²
this.$router.push('/index') 
// å¯¹è±¡
this.$router.push({ path: '/index' })
// å¸¦æŸ¥è¯¢å‚æ•°ï¼Œå˜æˆ/backend/order?selected=2/ï¼Œqueryä¼ å‚
this.$router.push({ path: '/index', query: {name: '123'} })
// å‘½åçš„è·¯ç”± paramsä¼ å‚
this.$router.push({ name: 'index', params: {name: '123'} })
```

### 3. propså‚æ•°

propsä½œç”¨ï¼šè®©è·¯ç”±ç»„ä»¶æ›´æ–¹ä¾¿çš„æ”¶åˆ°å‚æ•°ï¼Œå¯ä»¥å°†paramsã€queryå‚æ•°ï¼Œé€šè¿‡propsä¼ é€’ä¸ªè·¯ç”±ç»„ä»¶

```javascript
/* router/index.js æ–‡ä»¶ */
{
    name:'xiangqing',
    path:'detail/:id/:title',
    component:Detail,

    // ç¬¬ä¸€ç§å†™æ³•ï¼špropså€¼ä¸ºå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­æ‰€æœ‰çš„key-valueçš„ç»„åˆæœ€ç»ˆéƒ½ä¼šé€šè¿‡propsä¼ ç»™Detailç»„ä»¶
    // props:{a:900}

    // ç¬¬äºŒç§å†™æ³•ï¼špropså€¼ä¸ºå¸ƒå°”å€¼ï¼Œä¸ºtrueæ—¶ï¼Œåªèƒ½ä¼ é€’paramså‚æ•°
    // props:true

    // ç¬¬ä¸‰ç§å†™æ³•ï¼špropså€¼ä¸ºå‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›çš„å¯¹è±¡ä¸­æ¯ä¸€ç»„key-valueéƒ½ä¼šé€šè¿‡propsä¼ ç»™Detailç»„ä»¶
    // props($route){
    //     return { id: $route.query.id, title: $route.query.title }
    // }
    
    // æˆ–è€…
    props: ($route) => {
        return { id: $route.query.id, title: $route.query.title }
    }
}
```



## ç¼“å­˜è·¯ç”±ç»„ä»¶

[å‚è€ƒæ–‡ç« ](https://blog.csdn.net/liyunkun888/article/details/100537764)

**`<keep-alive></keep-alive>`**ï¼Œä½œç”¨ï¼šè®©ä¸å±•ç¤ºçš„è·¯ç”±ç»„ä»¶<strong style="color:#DD5415">ä¿æŒæŒ‚è½½ï¼Œä¸è¢«é”€æ¯</strong>

> æ³¨æ„ï¼šæ˜¯ç¼“å­˜é¡µé¢çš„ name åç§°ï¼Œè€Œä¸æ˜¯ç¼“å­˜é¡µé¢è·¯ç”±çš„ name åç§°

```vue
<!-- ç¼“å­˜ä¸€ä¸ªè·¯ç”±ç»„ä»¶ï¼Œincludeä¸­å†™æƒ³è¦ç¼“å­˜çš„ç»„ä»¶åï¼Œä¸å†™è¡¨ç¤ºå…¨éƒ¨ç¼“å­˜ -->
<keep-alive include="è¯¥è·¯ç”±çš„nameåç§°">
    <router-view></router-view>
</keep-alive>

<!-- ç¼“å­˜å¤šä¸ªè·¯ç”±ç»„ä»¶ï¼Œincludeå‰é¢åŠ ä¸€ä¸ªå†’å·: -->
<keep-alive :include="['News','Message']"> 
    <router-view></router-view>
</keep-alive>
```

## è·¯ç”±ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­

<strong style="color:#DD5415">activated</strong> å’Œ <strong style="color:#DD5415">deactivated</strong> æ˜¯**è·¯ç”±ç»„ä»¶**æ‰€ç‹¬æœ‰çš„ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œç”¨äº**æ•è·è·¯ç”±ç»„ä»¶çš„æ¿€æ´»çŠ¶æ€**

å…·ä½“ä½¿ç”¨ï¼š

- **activated** è·¯ç”±ç»„ä»¶**è¢«æ¿€æ´»**æ—¶è§¦å‘
- **deactivated** è·¯ç”±ç»„ä»¶**å¤±æ´»**æ—¶è§¦å‘

- activated å’Œ deactivated æ˜¯é…åˆ <strong style="color:#DD5415">keep-aliveæ ‡ç­¾</strong> ä¸€èµ·ä½¿ç”¨çš„
- activated å’Œ deactivated æ²¡æœ‰ keep-alive çš„æ—¶å€™æ˜¯ä¸ä¼šè¢«è§¦å‘çš„
- åœ¨å­˜åœ¨ keep-alive çš„æ—¶å€™å¯ä»¥å°† activated å½“ä½œ created è¿›è¡Œä½¿ç”¨
- deactivated æ˜¯ç»„ä»¶é”€æ¯çš„æ—¶å€™è§¦å‘ï¼Œæ­¤æ—¶çš„ destory æ˜¯ä¸æ‰§è¡Œçš„

## è·¯ç”±å®ˆå«

1. ä½œç”¨ï¼šå¯¹è·¯ç”±è¿›è¡Œ**æƒé™æ§åˆ¶** 
2. åˆ†ç±»ï¼šå…¨å±€å®ˆå«ã€ç‹¬äº«å®ˆå«ã€ç»„ä»¶å†…å®ˆå« 
3. æ‰§è¡Œé¡ºåºï¼š**å‰ç½®**è·¯ç”±ï¼Œ**ç‹¬äº«**è·¯ç”±ï¼Œè¿›å…¥è·¯ç”±ï¼Œ**åç½®**è·¯ç”±ï¼Œç¦»å¼€è·¯ç”±

### 1. å…¨å±€è·¯ç”±å®ˆå«

- å…¨å±€å‰ç½®å®ˆå«**beforeEach**

<strong style="color:#DD5145">`beforeEach`</strong> æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œ**to è¡¨ç¤ºè¦è·³è½¬åˆ°çš„è·¯ç”±ç»„ä»¶**ï¼Œ**from è¡¨ç¤ºå½“å‰çš„è·¯ç”±ç»„ä»¶**ï¼Œ**next è¡¨ç¤ºè¿›è¡Œè·³è½¬å‘½ä»¤**

- **`next()`**ï¼Œæ”¾è¡Œ
- **`next(false)`**ï¼Œä¸­æ–­å½“å‰å¯¼èˆª
- **`next('/')`**æˆ–**`next({path:'/'})`**ï¼Œè·³è½¬åˆ°ä¸€ä¸ªä¸åŒçš„åœ°å€



- å…¨å±€åç½®å®ˆå«**afterEach**

<strong style="color:#DD5145">`afterEach`</strong> åªæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œto è¡¨ç¤ºè¦è·³è½¬åˆ°çš„è·¯ç”±ç»„ä»¶ï¼Œfrom è¡¨ç¤ºå½“å‰çš„è·¯ç”±ç»„ä»¶

<strong style="color:#DD5145">è·¯ç”±å…ƒä¿¡æ¯</strong>ï¼šè·¯ç”±ä¸­**`meta`**è¿™ä¸ªé…ç½®é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªé…ç½®é¡¹ä¸­æ·»åŠ ä¸€äº›**è‡ªå®šä¹‰å‚æ•°**ï¼Œç”¨äºåç»­çš„åˆ¤æ–­

**`src/router/index.js`**

```javascript
// åˆ›å»ºä¸€ä¸ªè·¯ç”±å™¨
....
const router = new VueRouter({
    routes: [
        {
            path: '/home',
            component: Home,
            children: [
                {
                    path: 'bar',
                    component: Bar,
                    meta: { isAuth: true }	// è®¾ç½®è·¯ç”±å…ƒä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªè·¯ç”±èº«ä¸Šæºå¸¦çš„ä¿¡æ¯
                }
            ]
        }
        ....
    ]
})

// å…¨å±€å‰ç½®å®ˆå«ï¼šåˆå§‹åŒ–æ—¶ã€æ¯æ¬¡è·¯ç”±åˆ‡æ¢å‰æ‰§è¡Œ
router.beforeEach((to, from, next) => {
    console.log('beforeEach', to, from)
    if (to.meta.isAuth){ // åˆ¤æ–­å½“å‰è·¯ç”±æ˜¯å¦éœ€è¦è¿›è¡Œæƒé™æ§åˆ¶
        if (localStorage.getItem('school') === 'atguigu'){  // æƒé™æ§åˆ¶çš„å…·ä½“è§„åˆ™
            next()	// æ”¾è¡Œ
        } else{
            alert('æš‚æ— æƒé™æŸ¥çœ‹')
        }
    } else{
        next()	// æ”¾è¡Œ
    }
})

// å…¨å±€åç½®å®ˆå«ï¼šåˆå§‹åŒ–æ—¶ã€æ¯æ¬¡è·¯ç”±åˆ‡æ¢åæ‰§è¡Œ
router.afterEach((to, from) => {
    console.log('afterEach', to, from)
    if (to.meta.title){ 
        document.title = to.meta.title  // ä¿®æ”¹ç½‘é¡µçš„title
    } else{
        document.title = 'vue_test'
    }
})

....
// æš´éœ²ä¸€ä¸ªè·¯ç”±å™¨
export default router
```

### 2. è·¯ç”±ç‹¬äº«çš„å®ˆå«

ç‹¬äº«è·¯ç”±å®ˆå«åªæœ‰å‰ç½® <strong style="color:#DD5145">beforeEnter</strong>ï¼Œæ²¡æœ‰åç½®ã€‚

**`src/router/index.js`** é‡Œé¢çš„è·¯ç”±é…ç½® **`new VueRouter({})`** ä¸­ç¼–å†™

```javascript
{
    path: "/home",
    component: Home,
    // è·¯ç”±ç‹¬äº«å®ˆå«
    beforeEnter(to,from,next){
        console.log('beforeEnter', to, from)
        if (localStorage.getItem('school') === 'atguigu'){ // åˆ¤æ–­å½“å‰è·¯ç”±æ˜¯å¦éœ€è¦è¿›è¡Œæƒé™æ§åˆ¶
            next()
        } else{
            alert('æš‚æ— æƒé™æŸ¥çœ‹')
        }
    },
}
```

> å¯ä»¥å’Œ**å…¨å±€åç½®å®ˆå«**é…åˆä½¿ç”¨

### 3. ç»„ä»¶å†…è·¯ç”±å®ˆå«

- `beforeRouteEnter`
- `beforeRouteUpdate` (2.2 æ–°å¢)
- `beforeRouteLeave`

> å‰é¢çš„**å…¨å±€åç½®å®ˆå«**æ˜¯è·¯ç”±åˆ‡æ¢åè¢«è°ƒç”¨ï¼Œè¿™é‡Œ**ç»„ä»¶å†…çš„ç¦»å¼€å®ˆå«**æ˜¯ç¦»å¼€è¯¥ç»„ä»¶æ—¶è°ƒç”¨ï¼Œæ³¨æ„è¿™ä¸ªåŒºåˆ«ã€‚

**`src/pages/About.vue`** é‡Œé¢çš„ä¸­ **`export default{}`** ä¸­ç¼–å†™

```javascript
const Foo = {
    template: `...`,
    //è¿›å…¥å®ˆå«ï¼šé€šè¿‡è·¯ç”±è§„åˆ™ï¼Œè¿›å…¥è¯¥ç»„ä»¶æ—¶è¢«è°ƒç”¨
    beforeRouteEnter(to, from, next) {
        // åœ¨æ¸²æŸ“è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±è¢« confirm å‰è°ƒç”¨
        // ä¸ï¼èƒ½ï¼è·å–ç»„ä»¶å®ä¾‹ `this`
        // å› ä¸ºå½“å®ˆå«æ‰§è¡Œå‰ï¼Œç»„ä»¶å®ä¾‹è¿˜æ²¡è¢«åˆ›å»º
    },
    beforeRouteUpdate(to, from, next) {
        // åœ¨å½“å‰è·¯ç”±æ”¹å˜ï¼Œä½†æ˜¯è¯¥ç»„ä»¶è¢«å¤ç”¨æ—¶è°ƒç”¨
        // ä¸¾ä¾‹æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªå¸¦æœ‰åŠ¨æ€å‚æ•°çš„è·¯å¾„ /foo/:idï¼Œåœ¨ /foo/1 å’Œ /foo/2 ä¹‹é—´è·³è½¬çš„æ—¶å€™ï¼Œ
        // ç”±äºä¼šæ¸²æŸ“åŒæ ·çš„ Foo ç»„ä»¶ï¼Œå› æ­¤ç»„ä»¶å®ä¾‹ä¼šè¢«å¤ç”¨ã€‚è€Œè¿™ä¸ªé’©å­å°±ä¼šåœ¨è¿™ä¸ªæƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚
        // å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this`
    },
    //ç¦»å¼€å®ˆå«ï¼šé€šè¿‡è·¯ç”±è§„åˆ™ï¼Œç¦»å¼€è¯¥ç»„ä»¶æ—¶è¢«è°ƒç”¨
    beforeRouteLeave(to, from, next) {
        // å¯¼èˆªç¦»å¼€è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±æ—¶è°ƒç”¨
        // å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this`
    }
}
```

> å¯ä»¥å’Œ**å…¨å±€åç½®å®ˆå«**é…åˆä½¿ç”¨

æ‰§è¡Œé¡ºåºï¼Œå‰ç½®è·¯ç”±ï¼Œç‹¬äº«è·¯ç”±ï¼Œè¿›å…¥è·¯ç”±ï¼Œåç½®è·¯ç”±ï¼Œç¦»å¼€è·¯ç”±



## ä¸¤ç§å·¥ä½œæ¨¡å¼

`vue-router` é»˜è®¤ hash æ¨¡å¼ â€”â€” ä½¿ç”¨ URL çš„ hash æ¥æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„ URLï¼Œäºæ˜¯å½“ URL æ”¹å˜æ—¶ï¼Œé¡µé¢ä¸ä¼šé‡æ–°åŠ è½½ã€‚

1. å¯¹äºä¸€ä¸ªurlæ¥è¯´ï¼Œä»€ä¹ˆæ˜¯hashå€¼ï¼Ÿ

> **\#** åŠå…¶åé¢çš„å†…å®¹å°±æ˜¯hashå€¼

2. hashå€¼ä¸ä¼šåŒ…å«åœ¨HTTPè¯·æ±‚ä¸­ï¼Œå³ï¼šhashå€¼ä¸ä¼šå¸¦ç»™æœåŠ¡å™¨ 

3. **hashæ¨¡å¼** 

- åœ°å€ä¸­æ°¸è¿œå¸¦ç€#å·ï¼Œä¸ç¾è§‚
- è‹¥ä»¥åå°†åœ°å€é€šè¿‡ç¬¬ä¸‰æ–¹æ‰‹æœºappåˆ†äº«ï¼Œè‹¥appæ ¡éªŒä¸¥æ ¼ï¼Œåˆ™åœ°å€ä¼šè¢«æ ‡è®°ä¸ºä¸åˆæ³•
- å…¼å®¹æ€§è¾ƒå¥½

4. **historyæ¨¡å¼**

- åœ°å€å¹²å‡€ï¼Œç¾è§‚
- å…¼å®¹æ€§å’Œhashæ¨¡å¼ç›¸æ¯”ç•¥å·®
- åº”ç”¨éƒ¨ç½²ä¸Šçº¿æ—¶éœ€è¦åç«¯äººå‘˜æ”¯æŒï¼Œè§£å†³åˆ·æ–°é¡µé¢æœåŠ¡ç«¯404çš„é—®é¢˜

```javascript
const router =  new VueRouter({
	mode: 'history',
	routes: [...]
})
export default router
```



## æ»šåŠ¨è¡Œä¸º

ç”¨å‰ç«¯è·¯ç”±ï¼Œå½“åˆ‡æ¢åˆ°æ–°è·¯ç”±æ—¶ï¼Œæƒ³è¦é¡µé¢æ»šåˆ°é¡¶éƒ¨ï¼Œæˆ–è€…æ˜¯ä¿æŒåŸå…ˆçš„æ»šåŠ¨ä½ç½®ï¼Œå°±åƒé‡æ–°åŠ è½½é¡µé¢é‚£æ ·ã€‚ `vue-router` èƒ½åšåˆ°ï¼Œè€Œä¸”æ›´å¥½ï¼Œå®ƒè®©ä½ å¯ä»¥è‡ªå®šä¹‰è·¯ç”±åˆ‡æ¢æ—¶é¡µé¢å¦‚ä½•æ»šåŠ¨ã€‚

```js
// é…ç½®è·¯ç”±
const router = new VueRouter({
    routes,	// å¤–éƒ¨å¯¼å…¥çš„è‡ªå®šä¹‰è·¯ç”±è§„åˆ™
    scrollBehavior(to, from, savedPosition) {
        // return æœŸæœ›æ»šåŠ¨åˆ°å“ªä¸ªçš„ä½ç½®
        return { x: 0, y: 0 } // y = 0 ä»£è¡¨æ»šåŠ¨æ¡åœ¨æœ€ä¸Šæ–¹
        // return { top: 0 } // Vue3ä½¿ç”¨
    }
})
export default router
```



